#
# By Chih-Wei Huang <cwhuang@linux.org.tw>
# Last updated 2010/11/17
#
# License: GNU Public License
# We explicitely grant the right to use the scripts
# with Android-x86 project.
#

mount_data()
{
	mountpoint -q data && return
	if [ -b "$DATA" ]; then
		mount $DATA data
	elif [ -b "/dev/$DATA" ]; then
		mount /dev/$DATA data
	elif [ -d /mnt/$SRC/data ]; then
		mount -o remount,rw /mnt
		mount --bind /mnt/$SRC/data data
	elif [ -f /mnt/$SRC/data.img ]; then
		mount -o remount,rw /mnt
		mount -o loop /mnt/$SRC/data.img data
	else
		device_mount_data || mount -t tmpfs tmpfs data
	fi
}

mount_sdcard()
{
	mountpoint -q sdcard && return
	# WARNING: premount the sdcard is deprecated since froyo-x86.
	# It is left only for backward compatibility and may be removed
	# in the future.
	if [ "$SDCARD" = "premount" ]; then
		if [ -d /mnt/$SRC/sdcard ]; then
			mount -o remount,rw /mnt
			mount --bind /mnt/$SRC/sdcard mnt/sdcard
		elif [ -d data/sdcard ]; then
			mount --bind data/sdcard mnt/sdcard
		else
			mount -o mode=2777,uid=1000,gid=1015 -t tmpfs tmpfs mnt/sdcard
		fi
	fi
}
